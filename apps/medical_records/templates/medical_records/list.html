{% extends "base.html" %}

{% block title %}
Danh sách bệnh án
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h4 mb-0">Danh sách bệnh án</h1>
  <a href="{% url 'medical_records:select_patient' %}" class="btn btn-primary">
    <i class="bi bi-plus-lg me-1"></i> Tạo bệnh án
  </a>
</div>

<div class="table-responsive shadow-sm rounded">
  <table class="table table-hover mb-0">
    <thead class="table-light">
      <tr>
        <th>Ngày khám</th>
        <th>Bệnh nhân</th>
        <th>Chẩn đoán</th>
        <th class="text-end">Hành động</th>
      </tr>
    </thead>
    <tbody>
      {% for r in page_obj.object_list %}
        <tr
          class="clickable-row"
          style="cursor: pointer"
          onclick="window.location.href='{% url 'medical_records:detail' r.pk %}'"
        >
          <td>{{ r.record_date|date:"d/m/Y" }}</td>
          <td>{{ r.patient.full_name }}</td>
          <td>{{ r.diagnosis|truncatechars:40 }}</td>
          <td class="text-end">
            <a
              href="{% url 'medical_records:edit' r.pk %}"
              class="btn btn-sm btn-outline-secondary me-1"
              onclick="event.stopPropagation();"
              title="Chỉnh sửa"
            >
              <i class="bi bi-pencil"></i>
            </a>
            <a
              href="{% url 'medical_records:detail' r.pk %}"
              class="btn btn-sm btn-outline-primary"
              onclick="event.stopPropagation();"
              title="Xem chi tiết"
            >
              <i class="bi bi-eye"></i>
            </a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="4" class="text-center py-3">Chưa có bệnh án.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% include "partials/pagination.html" with page_obj=page_obj %}
{% endblock %}
